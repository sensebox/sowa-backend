// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Device {
  id          Int           @id @default(autoincrement())
  label       Translation[]
  sensors     Sensor[]      @relation(references: [id])
  description String?       @db.VarChar(4096)
  markdown    String?       @db.VarChar(4096)
  validation  Boolean       @default(false)
}

model Sensor {
  id         Int          @id @default(autoincrement())
  name       String       @db.VarChar(255)
  devices    Device[]
  phenomena  Phenomenon[]
  validation Boolean      @default(false)
}

model Phenomenon {
  id          Int             @id @default(autoincrement())
  description String?         @db.VarChar(255)
  label       String
  markdown    String?         @db.VarChar(4096)
  validation  Boolean         @default(false)
  domains     Domain[]        @relation(references: [id])
  sensors     Sensor[]        @relation(references: [id])
  rov         RangeOfValues[]
}

model RangeOfValues {
  min          Int
  max          Int
  unit         Unit       @relation(fields: [unitId], references: [id])
  unitId       Int
  phenomenon   Phenomenon @relation(fields: [phenomenonId], references: [id])
  phenomenonId Int

  @@unique([min, max])
}

model Unit {
  id   Int             @id @default(autoincrement())
  name String          @db.VarChar(255)
  rov  RangeOfValues[]
}

model Domain {
  id        Int          @id @default(autoincrement())
  phenomena Phenomenon[]
}

model Language {
  id              Int               @id @default(autoincrement())
  code            String            @db.VarChar(2)
  TranslationItem TranslationItem[]
}

model Translation {
  id              Int               @id @default(autoincrement())
  Device          Device?           @relation(fields: [deviceId], references: [id])
  deviceId        Int?
  TranslationItem TranslationItem[]
}

model TranslationItem {
  id            Int         @id @default(autoincrement())
  translation   Translation @relation(fields: [translationId], references: [id])
  translationId Int
  language      Language    @relation(fields: [languageId], references: [id])
  languageId    Int
  text          String      @db.VarChar(4096)
}
